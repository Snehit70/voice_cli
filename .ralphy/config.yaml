project:
  name: "voice-cli"
  language: "TypeScript"
  framework: "Node.js"
  description: "Production-ready speech-to-text daemon for Linux with global hotkey support"

commands:
  test: "bun test"
  lint: "bun run lint"
  build: "bun run build"
  dev: "bun run dev"

rules:
  # TypeScript & Code Quality
  - "use TypeScript strict mode for all files"
  - "minimize 'any' usage - only use when absolutely necessary"
  - "write self-documenting code with clear variable and function names"
  - "prefer functional programming patterns where appropriate"
  - "use async/await for all asynchronous operations"
  
  # Error Handling
  - "add comprehensive error handling to all functions"
  - "all error messages must be user-friendly and actionable"
  - "log all errors to structured log files (JSON format)"
  - "show critical errors via desktop notifications"
  - "implement retry logic: max 2 attempts with short backoff (100ms, 200ms)"
  - "fail fast - prioritize speed over exhaustive retries"
  
  # API Integration
  - "use Groq SDK for Whisper Large V3 transcription"
  - "use Deepgram SDK for Nova-3 transcription"
  - "execute Groq and Deepgram in parallel using Promise.all"
  - "implement fallback: if one API fails, use the other"
  - "validate API keys before making requests"
  - "add timeout handling for all API calls"
  
  # Clipboard (CRITICAL)
  - "NEVER overwrite clipboard content - ALWAYS append to clipboard history"
  - "verify clipboard append mode works correctly - this is critical"
  - "preserve previous clipboard content at all times"
  - "test clipboard behavior thoroughly on Wayland and X11"
  
  # Audio Recording
  - "reject recordings shorter than 0.6 seconds"
  - "auto-stop recordings at 5 minutes"
  - "send desktop notifications at 4:00 and 4:30 minutes"
  - "detect silent audio and warn user"
  - "research and use production-ready audio library for Linux"
  
  # Daemon Management
  - "implement systemd service integration for Linux"
  - "support daemon start/stop/restart/status commands"
  - "implement auto-restart on crash (max 3 crashes in 5 minutes)"
  - "stop daemon and alert user after max restart limit"
  - "track daemon state: idle/recording/processing/error"
  
  # Hotkey System
  - "use node-global-key-listener for global hotkey support"
  - "default hotkey: Right Control key"
  - "implement toggle mode: press to start, press again to stop"
  - "validate hotkey configuration from config file"
  - "prioritize Wayland support (Hyprland first)"
  
  # Configuration
  - "store config in ~/.config/voice-cli/config.json"
  - "validate API key formats: Groq (starts with gsk_), Deepgram (UUID)"
  - "validate boost words: max 450 words (~500 tokens)"
  - "set config file permissions to 600 (user read/write only)"
  - "support environment variables as fallback"
  
  # Validation
  - "validate all user inputs before processing"
  - "provide clear validation error messages"
  - "enforce boost words limit: 450 words maximum"
  - "validate hotkey is a valid key combination"
  
  # Logging
  - "use structured logging (JSON format) for all logs"
  - "store logs in ~/.config/voice-cli/logs/"
  - "implement log rotation (daily logs, keep last 7 days)"
  - "log all transcriptions with full details for debugging"
  - "include timestamps, error types, stack traces in logs"
  
  # Testing
  - "write unit tests for all core logic"
  - "write integration tests for API calls"
  - "achieve 80%+ test coverage"
  - "test error handling paths thoroughly"
  - "use Vitest as testing framework"
  
  # Documentation
  - "add JSDoc comments for complex logic only"
  - "write comprehensive README with installation and setup"
  - "document all configuration options"
  - "create troubleshooting guide for common errors"
  - "document architecture for contributors"
  
  # Desktop Notifications
  - "send notification when recording starts"
  - "send notification when recording stops"
  - "send notification when transcription is ready"
  - "send notification for errors and warnings"
  - "test notifications on GNOME, KDE, and Hyprland"
  
  # Platform Support
  - "prioritize Wayland support (Hyprland first)"
  - "support X11 if possible"
  - "test on Ubuntu, Fedora, and Arch Linux"
  - "ensure compatibility with all major Linux distros"

boundaries:
  never_touch:
    - "node_modules/**"
    - "*.lock"
    - ".git/**"
    - "user's existing clipboard content (CRITICAL - never overwrite)"

capabilities:
  browser: false  # No browser automation needed for this project
